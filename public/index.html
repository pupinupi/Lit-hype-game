<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>–õ–∏—Ç–≤–∏–Ω. –ü—É—Ç—å –∫ —Ö–∞–π–ø—É</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<style>
body{font-family:Arial;text-align:center;background:#111;color:white;}
input, select{padding:8px;margin:5px;}
button{padding:10px 20px;margin:10px;font-size:18px;}
#game{display:none;}
#board-container{position:relative;width:1024px;height:1024px;margin:20px auto;}
#board{width:100%;height:100%;}
.piece{width:30px;height:30px;border-radius:50%;position:absolute;transition: all 0.7s ease;}
.yellow{background:yellow;}
.red{background:red;}
.blue{background:blue;}
.purple{background:purple;}
#dice{font-size:50px;margin:10px;}
</style>
</head>
<body>

<h1>–õ–∏—Ç–≤–∏–Ω. –ü—É—Ç—å –∫ —Ö–∞–π–ø—É</h1>

<div id="lobby">
<input id="name" placeholder="–ò–º—è"><br>
<input id="room" placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã"><br>
<select id="color">
<option value="yellow">–ñ–µ–ª—Ç–∞—è</option>
<option value="red">–ö—Ä–∞—Å–Ω–∞—è</option>
<option value="blue">–°–∏–Ω—è—è</option>
<option value="purple">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</option>
</select><br>
<button onclick="join()">–í–æ–π—Ç–∏</button>
</div>

<div id="game">
<h3 id="players"></h3>
<div id="board-container">
<img src="board.jpg" id="board">
</div>
<div id="dice">üé≤</div>
<button onclick="roll()">–ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫</button>
<h3 id="info"></h3>
</div>

<script>
const socket=io();
let currentRoom="";
let playerColor="";
let pieces={};

// —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–µ—Ç–æ–∫
const positions=[
  [91,583],[102,450],[80,345],[99,232],[99,133],
  [218,97],[348,91],[500,88],[624,102],[762,91],
  [895,130],[912,204],[912,337],[909,425],[901,580],
  [771,588],[641,588],[483,594],[331,586],[218,594]
];

function join(){
  const name=document.getElementById("name").value;
  const room=document.getElementById("room").value;
  const color=document.getElementById("color").value;
  if(!name||!room) return;
  currentRoom=room;
  playerColor=color;
  socket.emit("joinRoom",{name,room,color});
  document.getElementById("lobby").style.display="none";
  document.getElementById("game").style.display="block";
}

function roll(){
  const diceNum=Math.floor(Math.random()*6)+1;
  document.getElementById("dice").innerText="üé≤ "+diceNum;
  socket.emit("rollDice",{room:currentRoom});
}

socket.on("updateRoom", game=>{
  let text="";
  game.players.forEach(p=>{
    text+=p.name+" | –•–∞–π–ø: "+p.hype+"<br>";

    if(!pieces[p.id]){
      const div=document.createElement("div");
      div.className="piece "+p.color;
      div.style.left=positions[p.position][0]+"px";
      div.style.top=positions[p.position][1]+"px";
      document.getElementById("board-container").appendChild(div);
      pieces[p.id]=div;
    } else {
      pieces[p.id].style.left=positions[p.position][0]+"px";
      pieces[p.id].style.top=positions[p.position][1]+"px";
    }
  });

  document.getElementById("players").innerHTML=text;
  const current=game.players[game.turn];
  document.getElementById("info").innerText="–•–æ–¥ –∏–≥—Ä–æ–∫–∞: "+current.name;
});

socket.on("gameOver", winner=>{
  alert("–ü–æ–±–µ–¥–∏–ª "+winner.name+" üéâ");
});
</script>
</body>
</html>
